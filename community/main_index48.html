<!DOCTYPE html> 
<html lang="ko"> 
    <head> <meta charset="UTF-8"> 
    <meta name="viewport" 
    content="width=device-width, initial-scale=1.0"> 
    <title>ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ</title> 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> 
    <style> 
    
    * {
     box-sizing: border-box;   
    }
    
    /* ìˆ¨ê²¨ì§„ ìš”ì†Œ ìŠ¤íƒ€ì¼ */ 
    
    .hidden { display: none; }
    /* ê¸°ë³¸ ë°”ë”” ìŠ¤íƒ€ì¼ */
    
    body{
        margin: 0;
        padding: 0;
    }
    
    /* ê²Œì‹œíŒ íƒ€ì´í‹€ ìŠ¤íƒ€ì¼ */
    .title-wrapper{
        background-color: #f9d6e8;
        height: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .title{
        font-size: 30px;
        font-weight: bold;
        color: #ffffff;
        font-family: "ë§‘ì€ ê³ ë”•", "Arial", sans-serif;
    }

    /* ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .comments-list {
        list-style-type: none;
        padding: 0;
    }
    
    /* ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .button-list {
        display: flex;
        flex-direction: column;
    }

    /* ë²„íŠ¼ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
    .btn-group {
        margin-bottom: 1rem
    }

    /* ê²Œì‹œë¬¼ ë¦¬ìŠ¤íŠ¸ ë§ˆì§„ ìŠ¤íƒ€ì¼ */
    #post-list {
        margin-top: 1.5rem;
    }
/* ì´ëª¨í‹°ì½˜ í¼ */
.emoji-picker {
  display: none;
  position: absolute;
  z-index: 2; /* ì¶”ê°€ */
  background-color: white; /* ì¶”ê°€ */
  padding: 1rem; /* ì¶”ê°€ */
  border: 1px solid #ccc; /* ì¶”ê°€ */
  border-radius: 5px; /* ì¶”ê°€ */
}

        /* ì´ëª¨í‹°ì½˜ ë²„íŠ¼ */
        .emoji-button {
          position: relative;
        }
</style>
</head> <body> <!-- íƒ€ì´í‹€ í‘œì‹œ --> <div class="title-wrapper"> <span class="title">ë‚˜í˜¼ìì‚´ë˜</span> </div>
<!-- ì»¨í…Œì´ë„ˆ ì„¤ì • -->
<div class="container">
    <h1 class="my-4">ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ</h1>
    <div>
        <!-- ë²„íŠ¼ ê·¸ë£¹ ì„¤ì • -->
        <div class="col-md-8 button-list">
            <div class="btn-group" role="group"> 
                <button id="writeButton" onclick="showPostWrite();" class="btn btn-primary mb-4">ê¸€ ì‘ì„±í•˜ê¸°</button>
                <button id="allPostsButton" onclick="showAllPosts();" class="btn btn-info mb-4">ì „ì²´ ê¸€ ë³´ê¸°</button>
                <button id="categoryPostsButton1" onclick="showCategoryPosts('ì—¬í–‰ì§€');" class="btn btn-info mb-4">ì—¬í–‰ì§€ ê¸€ë³´ê¸°</button>
                <button id="categoryPostsButton2" onclick="showCategoryPosts('ìƒí™œ');" class="btn btn-info mb-4">ìƒí™œ ê¸€ë³´ê¸°</button>
                <button id="topPostsButton" onclick="showTopPosts();" class="btn btn-info mb-4">ì¶”ì²œ ë§ì´ ë°›ì€ ê¸€ ë³´ê¸°</button>

            </div>
            <!-- ê²Œì‹œë¬¼ ë¦¬ìŠ¤íŠ¸ ìˆ¨ê¹€ ì„¤ì • -->
            <ul id="post-list" class="hidden"></ul>
        </div>

        <!-- ì‘ì„± í¼ ì„¤ì • ë° ë°˜ì‘ ì„¤ì • -->
        <form id="post-write-form" class="post-write hidden" onsubmit="return false;">
            <div class="form-group">
                <label for="post-title">ì œëª©</label>
                <input type="text" class="form-control" id="post-title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label for="post-category">ì¹´í…Œê³ ë¦¬</label>
                <select class="form-control" id="post-category">
                    <option value="ì¡ë‹´">ì¡ë‹´</option>
                    <option value="ì—¬í–‰ì§€">ì—¬í–‰ì§€</option>
                    <option value="ìƒí™œ">ìƒí™œ</option>
                   
                </select>
            </div>
            <div class="form-group">
                <label for="post-content">ë‚´ìš©</label>
                <textarea class="form-control" id="post-content" rows="5" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
            <div class="form-group">
                <label for="post-image">ì´ë¯¸ì§€ ì²¨ë¶€</label>
                <input type="file" class="form-control-file" id="post-image" accept="image/*">
            </div>
            <!-- ìœ íŠœë¸Œ ë§í¬ ì…ë ¥ ì„¤ì • -->
            <div class="form-group">
                <label for="youtube-url">ìœ íŠœë¸Œ URL (ì„ íƒ):</label>
                <input type="text" class="form-control" id="youtube-url" placeholder="ìœ íŠœë¸Œ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <button onclick="savePost();" class="btn btn-primary">ì‘ì„±ì™„ë£Œ</button>
            <button onclick="showPostList();" type="button" class="btn btn-secondary">ì·¨ì†Œ</button>
        </form>
        
        <!-- ê²Œì‹œë¬¼ ë””í…Œì¼ ì„¤ì • -->
        <div id="post-view" class="post-view hidden">
        </div>
        
    </div>
</div>

    <script>  
        /* ì´ˆê¸°í™” ë° ì „ì—­ ë³€ìˆ˜ ì„¤ì • */
        let currentPostIndex;
        const savedPosts = [];
        const postListElem = document.getElementById('post-list');
        const postWriteForm = document.getElementById('post-write-form');
        const postView = document.getElementById('post-view');

           /* í¼ ì´ˆê¸°í™” í•¨ìˆ˜ */
        function resetForm() {
            document.getElementById('post-title').value = '';
            document.getElementById('post-content').value = '';
            document.getElementById('post-image').value = '';
            document.getElementById('youtube-url').value = ''; // ì¶”ê°€
        }

         /* ì‘ì„±í™”ë©´ ì—´ê¸° í•¨ìˆ˜ */
        function showPostWrite() {
            postListElem.classList.add('hidden');
            postWriteForm.classList.remove('hidden');
            postView.classList.add('hidden');
      }

      /* ë¦¬ìŠ¤íŠ¸í™”ë©´ ì—´ê¸° í•¨ìˆ˜ */
        function showPostList() {
            postListElem.classList.remove('hidden');
            postWriteForm.classList.add('hidden');
            postView.classList.add('hidden');
            resetForm();
            renderPostList();
            document.getElementById('writeButton').style.display = 'block';
            document.getElementById('topPostsButton').style.display = 'block';
            document.querySelector('.btn-group').classList.remove('hidden');
        }

          /* ë””í…Œì¼ í™”ë©´ ì—´ê¸° í•¨ìˆ˜ */
        function showPostDetail(index) {
            postListElem.classList.add('hidden');
            postWriteForm.classList.add('hidden');
            postView.classList.remove('hidden');
            renderPostDetail(index);
            document.getElementById("writeButton").style.display = "none";
            document.getElementById("topPostsButton").style.display = "none";
            document.querySelector('.btn-group').classList.add('hidden');
            renderPostDetail(index);
        document.getElementById('post-list').classList.add('hidden');
        }

        /* ì‘ì„± ë‚´ìš© ì €ì¥ í•¨ìˆ˜ */
        function savePost() {
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            const file = document.getElementById('post-image').files[0];
            const youtubeUrl = document.getElementById('youtube-url').value;
            const category = document.getElementById('post-category').value;

              /* ì €ì¥ */
            savedPosts.push({
                title,
                content,
                file,
                youtubeUrl,
                category, // ì¹´í…Œê³ ë¦¬ ì¶”ê°€
                upVotes: 0,
                downVotes: 0,
                comments: [],
            });

            showPostList();
        }

         /* ê²Œì‹œë¬¼ ë¦¬ìŠ¤íŠ¸ ë Œë” í•¨ìˆ˜ */
        function renderPostList(posts = savedPosts) {
            postListElem.innerHTML = '';

            posts.forEach((post, index) => {
                postListElem.innerHTML += `
                    <li class="list-group-item" onclick="showPostDetail(${index})">
                        <span>${post.title}</span> - <span>${post.category}</span>
                    </li>`;
            });
        }

            /* ê²Œì‹œë¬¼ ë””í…Œì¼ ë Œë” í•¨ìˆ˜ */
        function renderPostDetail(index) {
            currentPostIndex = index;
            const post = savedPosts[index];
            const reader = new FileReader();
        
            const videoId = getYouTubeVideoId(post.youtubeUrl); // ì¶”ê°€

            reader.onloadend = function () {
                postView.innerHTML = `
                    <h2>${post.title}</h2>
                    
                    ${post.file ? `<img src="${reader.result}" alt="" >` : ''}
                    <p>${post.content}</p>
                    ${post.youtubeUrl ? `<iframe width="560" height="315" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>` : ""}
                    <div class="mt-3">
                        <button id="upvote-count" onclick="upVote(currentPostIndex)" class="btn btn-link">&#128077; ${post.upVotes}</button>
                        <button id="downvote-count" onclick="downVote(currentPostIndex)" class="btn btn-link">&#128078; ${post.downVotes}</button>
                        <button onclick="showPostList()" class="btn btn-secondary">ë’¤ë¡œ</button>
                    </div>
                    <div id="comments-section">
                        <h2>ëŒ“ê¸€ ëª©ë¡</h2>
                        <ul id="comments-list" class="comments-list"></ul>
                        <h5>ëŒ“ê¸€ ì‘ì„±</h5>
                        <form id="comment-form" onsubmit="addComment(event); return false;">
                            <input type="text" class="form-control" id="comment-text" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”">
                            <button type="submit" class="btn btn-primary mt-2">ëŒ“ê¸€ë‹¬ê¸°</button>
                        </form>
                    </div>`;
                    const emojiPicker = document.createElement('div');
emojiPicker.id = 'emoji-picker';
emojiPicker.className = 'emoji-picker';
emojiPicker.innerHTML = `
  <button onclick="insertEmoji('ğŸ˜Š')">ğŸ˜Š</button>
  <button onclick="insertEmoji('ğŸ˜')">ğŸ˜</button>
  <button onclick="insertEmoji('ğŸ˜‚')">ğŸ˜‚</button>
  <button onclick="insertEmoji('ğŸ˜')">ğŸ˜</button>
  <button onclick="insertEmoji('ğŸ˜¢')">ğŸ˜¢</button>`;
document.getElementById('comments-section').appendChild(emojiPicker);

const emojiButton = document.createElement('div');
emojiButton.className = 'emoji-button';
emojiButton.innerHTML = `<button onclick="toggleEmojiPicker()">ì´ëª¨í‹°ì½˜</button>`;
document.getElementById('comment-form').insertBefore(emojiButton, document.getElementById('comment-form').firstChild);
                renderComments();
            };

            if (post.file) {
                reader.readAsDataURL(post.file);
            } else {
                reader.onloadend();
            }
        }

        //ìœ íŠœë¸Œ ë§í¬ ì¶”ê°€
        function getYouTubeVideoId(url) {
            const regex = /(?:youtube(?:-nocookie)?\.com\/[^\/\s]+\/|(?:https?:\/\/)?(?:www\.)?(?:youtube.com\/watch\?(?:.*&)v=|(?:youtu\.be\/)))([0-9A-Za-z-_]{11})/;
            const match = url.match(regex);
            return match && match[1] ? match[1] : null;
        }

        renderPostList();

        function addComment(event) {
    event.preventDefault();
    const commentText = document.getElementById("comment-text").value.trim();
    const commentAuthor = "ì‚¬ìš©ì ë‹‰ë„¤ì„";

    if (commentText.length === 0) {
        return;
    }

    const commentTime = new Date().toLocaleString();
    savedPosts[currentPostIndex].comments.push({ text: commentText, author: commentAuthor, time: commentTime });
    document.getElementById("comment-text").value = "";
    renderComments();
}
        function renderComments() {
            const commentsListElem = document.getElementById('comments-list');
            const comments = savedPosts[currentPostIndex].comments;
            commentsListElem.innerHTML = '';
            comments.forEach((comment, index) => {
                commentsListElem.innerHTML += `<li class="list-group-item"><strong>${comment.author}</strong> (${comment.time}): ${comment.text}</li>`;
            });
        }
        function upVote(index) {
            savedPosts[index].upVotes += 1;
            updateVoteCount(index);
        }

        function downVote(index) {
            savedPosts[index].downVotes += 1;
            updateVoteCount(index);
        }

        function updateVoteCount(index) {
            const upvoteCount = document.getElementById('upvote-count');
            const downvoteCount = document.getElementById('downvote-count');
            upvoteCount.innerHTML = `&#128077; ${savedPosts[index].upVotes}`;
            downvoteCount.innerHTML = `&#128078; ${savedPosts[index].downVotes}`;
        }

        function showTopPosts() {
  const topPosts = savedPosts.filter(post => post.upVotes >= 5);
  postListElem.classList.remove('hidden');
  renderPostList(topPosts);
}

// ì¹´í…Œê³ ë¦¬ì— ë”°ë¥¸ ê²Œì‹œë¬¼ í•„í„°ë§ í•¨ìˆ˜ ì¶”ê°€
function showCategoryPosts(category) {
            const filteredPosts = savedPosts.filter((post) => post.category === category);
            renderPostList(filteredPosts);
        }

 //ì „ì²´ ê¸€ ë³´ê¸° í•¨ìˆ˜ ì¶”ê°€
        function showAllPosts() {
    renderPostList(savedPosts);
}

function toggleEmojiPicker() {
          const picker = document.getElementById('emoji-picker');
          picker.style.display = picker.style.display === 'none' ? 'block' : 'none';
        }

        function insertEmoji(emoji) {
          const commentText = document.getElementById('comment-text');
          commentText.value += emoji;
        }

       
        function toggleEmojiPicker() {
  const picker = document.getElementById('emoji-picker');
  picker.style.display = picker.style.display === 'none' ? 'block' : 'none';
}

function insertEmoji(emoji) {
  const commentText = document.getElementById('comment-text');
  commentText.value += emoji;
}

    </script>
</body>
</html>
